{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Veria Evidence Bundle (v0.1)",
  "type": "object",
  "properties": {
    "id": {
      "type": "string"
    },
    "version": {
      "type": "string",
      "const": "0.1"
    },
    "decision": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string"
        },
        "outcome": {
          "type": "string",
          "enum": [
            "allow",
            "deny",
            "review"
          ]
        },
        "inputs": {
          "type": "object"
        },
        "policyFingerprint": {
          "type": "string"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "outcome",
        "inputs",
        "policyFingerprint",
        "createdAt"
      ]
    },
    "hashes": {
      "type": "object",
      "properties": {
        "inputsSha256": {
          "type": "string"
        },
        "bundleSha256": {
          "type": "string"
        }
      },
      "required": [
        "inputsSha256"
      ]
    },
    "signer": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "keyId": {
          "type": "string"
        }
      },
      "required": [
        "name"
      ]
    }
  },
  "required": [
    "id",
    "version",
    "decision",
    "hashes",
    "signer"
  ]
}